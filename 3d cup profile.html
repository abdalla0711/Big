<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PaperCup - Professional 3D Showcase</title>
    <style>
        /* Basic Reset & Root Variables */
        :root {
            --bg-color: #f5f5f5;
            --text-color: #1a1a1a;
            --accent-color: #007bff;
            --header-bg: rgba(255, 255, 255, 0.8);
            --section-bg: #ffffff;
            --loader-bg: #ffffff;
            --loader-text: #1a1a1a;
            --button-bg: #007bff;
            --button-text: #ffffff;
            --button-hover-bg: #0056b3;
            --border-color: #e0e0e0;
        }

        [data-theme="dark"] {
            --bg-color: #121212;
            --text-color: #f5f5f5;
            --accent-color: #00aaff;
            --header-bg: rgba(20, 20, 20, 0.8);
            --section-bg: #1e1e1e;
            --loader-bg: #121212;
            --loader-text: #f5f5f5;
            --button-bg: #00aaff;
            --button-text: #121212;
            --button-hover-bg: #0077cc;
            --border-color: #333333;
        }

        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s ease, color 0.3s ease;
            overflow-x: hidden;
        }

        /* Accessibility */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--accent-color);
            color: var(--button-text);
            padding: 8px;
            z-index: 10000;
            transition: top 0.3s;
        }

        .skip-link:focus {
            top: 0;
        }

        /* Loader */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--loader-bg);
            color: var(--loader-text);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            z-index: 9999;
            transition: opacity 0.5s ease;
            opacity: 1;
        }

        .loading-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        /* Canvas */
        #webgl-canvas {
            position: fixed;
            top: 0;
            left: 0;
            outline: none;
            z-index: -1;
        }

        /* Header */
        header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            padding: 1rem 5%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            background: var(--header-bg);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        header .logo {
            font-weight: bold;
            font-size: 1.5rem;
        }

        header nav {
            display: flex;
            align-items: center;
        }

        header nav a {
            color: var(--text-color);
            text-decoration: none;
            margin: 0 1rem;
            transition: color 0.2s;
            font-weight: 500;
        }

        header nav a:hover {
            color: var(--accent-color);
        }

        .header-buttons {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .cta-button {
            background-color: var(--button-bg);
            color: var(--button-text);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }

        .cta-button:hover {
            background-color: var(--button-hover-bg);
        }

        .icon-button {
            background: none;
            border: 1px solid var(--border-color);
            border-radius: 50%;
            width: 36px;
            height: 36px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        .icon-button:hover {
            background-color: var(--section-bg);
        }

        /* Main Content & Sections */
        main {
            width: 100%;
            position: relative;
            z-index: 1;
        }

        section {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: flex-start;
            padding: 5rem 10%;
            max-width: 600px;
            pointer-events: none;
        }
        
        section > * {
            pointer-events: auto;
        }

        section.hero {
            justify-content: center;
            text-align: left;
        }
        
        .content-card {
            background-color: var(--section-bg);
            border-radius: 12px;
            padding: 2rem;
            margin: 10vh 0;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        h1, h2 {
            font-size: clamp(2rem, 5vw, 3.5rem);
            margin-bottom: 1rem;
            font-weight: 700;
        }

        p {
            font-size: clamp(1rem, 2.5vw, 1.2rem);
            line-height: 1.6;
            margin-bottom: 2rem;
            max-width: 500px;
        }

        .learn-more {
            padding: 0.75rem 1.5rem;
        }

        /* Interactive Gallery / Explore Mode UI */
        #explore-ui {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            background: var(--header-bg);
            backdrop-filter: blur(10px);
            padding: 1rem;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            display: flex;
            gap: 0.5rem;
            z-index: 1001;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }

        #explore-ui.visible {
            opacity: 1;
            visibility: visible;
        }
        
        #explore-ui button {
            font-size: 0.9rem;
        }

        /* RTL support */
        [dir="rtl"] header nav {
            margin-right: auto;
            margin-left: 0;
        }
        [dir="rtl"] section {
            align-items: flex-end;
            margin-left: auto;
            margin-right: 0;
        }
        [dir="rtl"] .content-card, [dir="rtl"] .hero {
             text-align: right;
        }

        /* Responsive */
        @media (max-width: 768px) {
            header nav {
                display: none;
            }
            header {
                padding: 1rem 5%;
            }
            section {
                padding: 4rem 5%;
                margin-left: auto;
                margin-right: auto;
                max-width: 90%;
            }
            .header-buttons {
                gap: 0.5rem;
            }
            .cta-button {
                font-size: 0.8rem;
                padding: 0.4rem 0.8rem;
            }
            #explore-ui {
                width: 90%;
                flex-wrap: wrap;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link" data-lang-en="Skip to main content" data-lang-ar="تجاوز إلى المحتوى الرئيسي">Skip to main content</a>

    <div class="loading-overlay">
        <p data-lang-en="Loading… Please wait" data-lang-ar="جار التحميل... يرجى الانتظار">Loading… Please wait</p>
    </div>
    
    <header>
        <div class="logo">PaperCup</div>
        <nav>
            <a href="#performance" data-lang-en="Features" data-lang-ar="المزايا">Features</a>
            <a href="#gallery" data-lang-en="Experience" data-lang-ar="جرّبها">Experience</a>
            <a href="#cta" data-lang-en="Buy" data-lang-ar="اشتري الآن">Buy</a>
        </nav>
        <div class="header-buttons">
            <button class="cta-button" id="explore-btn" data-lang-en="Explore in 3D" data-lang-ar="استكشف ثلاثي الأبعاد">Explore in 3D</button>
            <button class="icon-button" id="theme-toggle" aria-label="Toggle dark/light mode">🌙</button>
            <button class="icon-button" id="lang-toggle" data-lang-en="AR" data-lang-ar="EN">AR</button>
        </div>
    </header>

    <canvas id="webgl-canvas"></canvas>

    <main id="main-content">
        <section id="hero" class="hero">
            <div class="content-card">

            <h1 data-lang-en="Paper Cup – Professional 3D Showcase" data-lang-ar="كوب ورقي – عرض ثلاثي الأبعاد احترافي">Paper Cup – Professional 3D Showcase</h1>
            <p data-lang-en="Discover the perfect blend of design, performance, and sustainability." data-lang-ar="اكتشف المزيج المثالي بين التصميم والأداء والاستدامة."></p>
            <button class="cta-button learn-more" data-lang-en="Learn More" data-lang-ar="اعرف المزيد">Learn More</button>
                  </div>

  </section>

        <section id="performance">
            <div class="content-card">
                <h2 data-lang-en="Lightweight & Heat Resistant" data-lang-ar="خفيف الوزن ومقاوم للحرارة">Lightweight & Heat Resistant</h2>
                <p data-lang-en="Engineered for comfort and safety, our cups provide excellent insulation, keeping your hands cool and your drinks hot, all in a feather-light design." data-lang-ar="صُممت لتوفير الراحة والأمان، توفر أكوابنا عزلاً ممتازًا، مما يحافظ على برودة يديك وسخونة مشروباتك، كل ذلك في تصميم خفيف كالريشة."></p>
            </div>
        </section>

        <section id="strength">
            <div class="content-card">
                <h2 data-lang-en="Durable & Eco-Friendly" data-lang-ar="متين وصديق للبيئة">Durable & Eco-Friendly</h2>
                <p data-lang-en="Constructed from multiple layers of sustainably sourced paper, our cups are built to last without leaking, while also being fully recyclable and biodegradable." data-lang-ar="مصنوعة من طبقات متعددة من الورق المستدام، صُممت أكوابنا لتدوم دون تسريب، وهي أيضًا قابلة لإعادة التدوير والتحلل البيولوجي بالكامل."></p>
            </div>
        </section>
        
        <section id="detail">
            <div class="content-card">
                <h2 data-lang-en="Precision in Every Detail" data-lang-ar="دقة في كل تفصيلة">Precision in Every Detail</h2>
                <p data-lang-en="From the perfectly rolled rim for a smooth sipping experience to the textured grip, every aspect of our cup is crafted with meticulous attention to detail." data-lang-ar="من الحافة الملفوفة بإتقان لتجربة شرب سلسة إلى الملمس المحكم، تم تصميم كل جانب من جوانب كوبنا بعناية فائقة للتفاصيل."></p>
            </div>
        </section>

        <section id="gallery">
            <div class="content-card">
                <h2 data-lang-en="Interactive Gallery" data-lang-ar="معرض تفاعلي">Interactive Gallery</h2>
                <p data-lang-en="Explore the different styles and customize the cup to your liking. Click 'Explore in 3D' to start." data-lang-ar="استكشف الأنماط المختلفة وخصص الكوب حسب رغبتك. انقر على 'استكشف ثلاثي الأبعاد' للبدء."></p>
            </div>
        </section>
        
        <section id="cta">
            <div class="content-card">
                <h2 data-lang-en="Ready to Order?" data-lang-ar="هل أنت جاهز للطلب؟">Ready to Order?</h2>
                <p data-lang-en="Get the best paper cups for your business or event. High quality, sustainable, and customizable." data-lang-ar="احصل على أفضل الأكواب الورقية لعملك أو مناسبتك. جودة عالية، مستدامة، وقابلة للتخصيص."></p>
                <button class="cta-button cta-final" data-lang-en="Buy Now" data-lang-ar="اشتري الآن">Buy Now</button>
            </div>
        </section>
    </main>
    
    <div id="explore-ui">
        <button class="cta-button" data-material="white" data-lang-en="White" data-lang-ar="أبيض">White</button>
        <button class="cta-button" data-material="kraft" data-lang-en="Kraft" data-lang-ar="ورق مقوى">Kraft</button>
        <button class="cta-button" data-material="logo" data-lang-en="Logo Print" data-lang-ar="طباعة شعار">Logo Print</button>
        <button class="cta-button" id="cup-only-btn" data-lang-en="Cup Only" data-lang-ar="الكوب فقط">Cup Only</button>
        <button class="cta-button" id="exit-explore-btn" data-lang-en="Exit" data-lang-ar="خروج">Exit</button>
    </div>

    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.166.1/build/three.module.js",
            "three/examples/jsm/": "https://cdn.jsdelivr.net/npm/three@0.166.1/examples/jsm/",
            "gsap": "https://cdn.jsdelivr.net/npm/gsap@3.12.5/index.js",
            "gsap/ScrollTrigger": "https://cdn.jsdelivr.net/npm/gsap@3.12.5/ScrollTrigger.js"
        }
    }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';
        import { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';
        import gsap from 'gsap';
        import { ScrollTrigger } from 'gsap/ScrollTrigger';

        gsap.registerPlugin(ScrollTrigger);

        /**
         * App State
         */
        const state = {
            isExploreMode: false,
            isTabActive: true,
            prefersReducedMotion: window.matchMedia('(prefers-reduced-motion: reduce)').matches,
        };
        
        /**
         * Language and Theme Management
         */
        const langToggle = document.getElementById('lang-toggle');
        const themeToggle = document.getElementById('theme-toggle');
        let currentLang = 'en';

        function setLanguage(lang) {
            currentLang = lang;
            document.documentElement.lang = lang;
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
            document.querySelectorAll('[data-lang-en]').forEach(el => {
                const key = lang === 'ar' ? 'data-lang-ar' : 'data-lang-en';
                if (el.hasAttribute(key)) {
                    el.textContent = el.getAttribute(key);
                }
            });
            langToggle.textContent = lang === 'en' ? 'AR' : 'EN';
        }

        langToggle.addEventListener('click', () => {
            setLanguage(currentLang === 'en' ? 'ar' : 'en');
        });

        themeToggle.addEventListener('click', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', newTheme);
            themeToggle.textContent = newTheme === 'light' ? '🌙' : '☀️';
        });

        /**
         * Three.js Scene Setup
         */
        const canvas = document.getElementById('webgl-canvas');
        const loadingOverlay = document.querySelector('.loading-overlay');
        const scene = new THREE.Scene();
        
        const sizes = {
            width: window.innerWidth,
            height: window.innerHeight,
        };

        const camera = new THREE.PerspectiveCamera(45, sizes.width / sizes.height, 0.01, 100);
        camera.position.set(0, 0, 3);
        scene.add(camera);

        const renderer = new THREE.WebGLRenderer({
            canvas: canvas,
            antialias: true,
            alpha: true,
        });
        
        renderer.setSize(sizes.width, sizes.height);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 1.5));
        renderer.outputEncoding = THREE.sRGBEncoding;
        renderer.toneMapping = THREE.ACESFilmicToneMapping;
        renderer.toneMappingExposure = 1.2;
        renderer.physicallyCorrectLights = true;

        /**
         * Lighting
         */
        const hemisphereLight = new THREE.HemisphereLight(0xffffff, 0x444444, 1.5);
        scene.add(hemisphereLight);

        const directionalLight = new THREE.DirectionalLight(0xffffff, 3.5);
        directionalLight.position.set(5, 5, 5);
        scene.add(directionalLight);

        const fillLight = new THREE.DirectionalLight(0xffffff, 1.0);
        fillLight.position.set(-5, 2, 5);
        scene.add(fillLight);
        
        /**
         * Controls
         */
        const controls = new OrbitControls(camera, canvas);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.enabled = false;
        controls.minDistance = 0.7;
        controls.maxDistance = 2.2;
        controls.minPolarAngle = THREE.MathUtils.degToRad(20);
        controls.maxPolarAngle = THREE.MathUtils.degToRad(160);
        controls.enablePan = false;
        
        /**
         * Model Loading & Material Handling
         */
        const gltfLoader = new GLTFLoader();
        let cupModel = null;
        let swappableMesh = null; // Reference to the mesh whose material we will change
        let originalMaterial = null; // The material that comes with the GLB file

        const customMaterials = {
            white: new THREE.MeshStandardMaterial({ color: 0xf5f5f5, roughness: 0.9, metalness: 0 }),
            kraft: new THREE.MeshStandardMaterial({ color: 0xc6a27e, roughness: 0.95, metalness: 0 }),
        };
        
        gltfLoader.load(
            'https://files.catbox.moe/9kj0h8.glb',
            (gltf) => {
                cupModel = gltf.scene;
                
                const box = new THREE.Box3().setFromObject(cupModel);
                const size = box.getSize(new THREE.Vector3());
                const center = box.getCenter(new THREE.Vector3());

                const scale = 1.0 / size.y;
                cupModel.scale.set(scale, scale, scale);
                cupModel.position.sub(center.multiplyScalar(scale));

                // --- CORRECTED LOGIC ---
                // Find the main mesh and save its original material
                cupModel.traverse((child) => {
                    if (child.isMesh && !swappableMesh) {
                        swappableMesh = child; // Assume the first mesh is the main one
                        originalMaterial = child.material; // This is your design material
                    }
                });
                
                scene.add(cupModel);

                setupScrollAnimation();
                loadingOverlay.classList.add('hidden');
            },
            undefined, 
            (error) => {
                console.error('An error happened while loading the model:', error);
                loadingOverlay.querySelector('p').textContent = 'Error loading 3D model.';
            }
        );

        function setMaterial(materialName) {
            if (!swappableMesh) return;

            if (materialName === 'logo') {
                // "Logo Print" restores the original material from the file
                swappableMesh.material = originalMaterial;
            } else if (customMaterials[materialName]) {
                // Apply our custom "White" or "Kraft" materials
                swappableMesh.material = customMaterials[materialName];
            }
        }
        
        /**
         * Scroll Animation
         */
        function setupScrollAnimation() {
            if (!cupModel || state.prefersReducedMotion) return;

            const tl = gsap.timeline({
                scrollTrigger: {
                    trigger: 'main',
                    start: 'top top',
                    end: 'bottom bottom',
                    scrub: 1,
                    invalidateOnRefresh: true,
                },
            });
            
            const cameraTarget = { x: 0, y: 0, z: 0 };
            tl.to(cameraTarget, { y: 0.1, ease: 'power1.inOut' }, 'kf2');
            tl.to(cameraTarget, { y: -0.1, ease: 'power1.inOut' }, 'kf3');
            tl.to(cameraTarget, { y: 0, ease: 'power1.inOut' }, 'kf4');

            tl.fromTo(camera.position, {z: 2.0}, { z: 1.2, ease: 'power1.inOut' }, 0);
            tl.to(cupModel.rotation, { y: Math.PI * 0.4, ease: 'power1.inOut' }, '>');
            tl.to(camera.position, { x: 0.3, z: 1.1, ease: 'power1.inOut' }, '<');
            tl.to(cupModel.rotation, { x: -Math.PI * 0.2, y: Math.PI * 0.5, ease: 'power1.inOut' }, '>');
            tl.to(camera.position, { y: 0.3, z: 1.0, ease: 'power1.inOut' }, '<');
            tl.to(cupModel.rotation, { x: Math.PI * 0.2, y: Math.PI * 0.6, ease: 'power1.inOut' }, '>');
            tl.to(camera.position, { y: -0.3, z: 1.1, ease: 'power1.inOut' }, '<');
            tl.to(cupModel.rotation, { x: 0, y: Math.PI * 1.5, ease: 'power1.inOut' }, '>');
            tl.to(camera.position, { x: -0.5, y: 0.1, z: 1.0, ease: 'power1.inOut' }, '<');
            tl.to(cupModel.rotation, { y: Math.PI * 1.8, ease: 'power1.inOut' }, '>');
            tl.to(camera.position, { x: 0, y: 0, z: 0.8, ease: 'power1.inOut' }, '<');
            tl.to(cupModel.rotation, { x: 0, y: Math.PI * 2, z: 0, ease: 'power2.inOut' }, '>');
            tl.to(camera.position, { x: 0, y: 0, z: 2.0, ease: 'power2.inOut' }, '<');

            tl.eventCallback('onUpdate', () => {
                camera.lookAt(cameraTarget.x, cameraTarget.y, cameraTarget.z);
            });
        }
        
        /**
         * Explore Mode
         */
        const exploreBtn = document.getElementById('explore-btn');
        const exitExploreBtn = document.getElementById('exit-explore-btn');
        const exploreUI = document.getElementById('explore-ui');

        function enterExploreMode() {
            state.isExploreMode = true;
            controls.enabled = true;
            if (!state.prefersReducedMotion) ScrollTrigger.disable();
            document.body.style.overflow = 'hidden';
            exploreUI.classList.add('visible');
            gsap.to(camera.position, { x: 0, y: 0, z: 1.5, duration: 0.8, ease: 'power2.out' });
        }

        function exitExploreMode() {
            state.isExploreMode = false;
            controls.enabled = false;
            if (!state.prefersReducedMotion) ScrollTrigger.enable();
            document.body.style.overflow = '';
            exploreUI.classList.remove('visible');
            if (!state.prefersReducedMotion) ScrollTrigger.refresh();
        }

        exploreBtn.addEventListener('click', enterExploreMode);
        exitExploreBtn.addEventListener('click', exitExploreMode);
        
        exploreUI.addEventListener('click', (e) => {
            if (e.target.matches('[data-material]')) {
                setMaterial(e.target.dataset.material);
            }
        });
        
        document.getElementById('cup-only-btn').addEventListener('click', (e) => {
            const mainEl = document.querySelector('main');
            const headerEl = document.querySelector('header');
            const isHidden = mainEl.style.display === 'none';
            mainEl.style.display = isHidden ? '' : 'none';
            headerEl.style.display = isHidden ? '' : 'none';

            if (currentLang === 'en') {
                e.target.textContent = isHidden ? 'Cup Only' : 'Show UI';
            } else {
                e.target.textContent = isHidden ? 'الكوب فقط' : 'إظهار الواجهة';
            }
        });
        
        /**
         * Rendering & Animation Loop
         */
        const tick = () => {
            if (state.isTabActive) {
                if (state.isExploreMode) {
                    controls.update();
                }
                renderer.render(scene, camera);
            }
            window.requestAnimationFrame(tick);
        };

        tick();
        
        /**
         * Event Listeners & Handlers
         */
        window.addEventListener('resize', () => {
            sizes.width = window.innerWidth;
            sizes.height = window.innerHeight;

            camera.aspect = sizes.width / sizes.height;
            camera.updateProjectionMatrix();

            renderer.setSize(sizes.width, sizes.height);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 1.5));
            if (!state.prefersReducedMotion) ScrollTrigger.refresh();
        });
        
        document.addEventListener('visibilitychange', () => {
            state.isTabActive = document.visibilityState === 'visible';
        });

    </script>
</body>
</html>